!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var l=t[i]={i:i,l:!1,exports:{}};return e[i].call(l.exports,l,l.exports,n),l.l=!0,l.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(i,l,function(t){return e[t]}.bind(null,l));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({"./src/main.js":
/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
/*! exports provided: SceneTopCard */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: multi ./src/main.js (referenced with single entry) */function(e,t,n){"use strict";n.r(t),n.d(t,"SceneTopCard",(function(){return i}));class i{constructor(e){this.app=e,this.defalutNum=0,this.init()}init(){this.objArr=this.app.query("[userData/bbIdx]"),this.topCardInfoPanel(),this.createAllTopCard()}createAllTopCard(){for(let e=0,t=this.objArr.length;e<t;e++){let t=this.objArr[e];this.create(t)}}create(e){if(null==e)return;let t=e.userData.bbIdx,n=e.userData.bb3d;if(null==t||null==n)return;n=n.toLowerCase();let i=e.userData.title0;i=this.getDecodeText(i);let l=e.userData.title1;l=this.getDecodeText(l);let o=e.userData.title2;o=this.getDecodeText(o);let a=e.userData.title3;a=this.getDecodeText(a);let s={obj:e,bbIdx:t,title0:i,title1:l,title2:o,title3:a,scaleW:1,scaleH:1},r=e.userData.bbScaleW;null==r&&0!=isNaN(parseFloat(r))||(s.scaleW=parseFloat(r));let p=e.userData.bbScaleH;null!=p&&0==isNaN(parseFloat(p))&&(s.scaleH=parseFloat(p));let d=this.getHtml(s);$("#div3d").append($(d));let c={"文本值1 (title0)":i,"文本值2 (title1)":l,"文本值3 (title2)":o,"文本值4 (title3)":a,"顶牌样式编号 (bbIdx)":t,"是否3D化 (bb3d)":n,"打开方式 (bbModel)":e.userData.bbModel,"横向缩放 (bbScaleW)":parseFloat(r),"纵向缩放 (bbScaleH)":parseFloat(p)};"false"==n?this.createCardFor2d(s,c):"true"==n&&this.createCardFor3d(s,c)}createCardFor2d(e,t){if(null==e)return null;let n="scene-card-"+e.obj.id,i=e.obj.position,l=e.obj.boundingBox.center,o=e.obj.size,a=[l[0]-i[0],o[1]/2+.2,l[2]-i[2]],s=this.getPivotPixel(e),r={type:"UIAnchor",parent:e.obj,element:$("#"+n)[0],localPosition:a,pivotPixel:s},p=this.app.create(r);p.visible=!1,e.obj.userData.sceneCard=p,this.registerEvent(e.obj,t)}createCardFor3d(e,t){if(null==e)return null;var n=this;let i="scene-card-"+e.obj.id;$("#"+i).length<=0||html2canvas($("#"+i)[0],{backgroundColor:"#00000000",scale:1}).then(i=>{let l=new THREE.Texture(i);l.needsUpdate=!0,l.magFilter=THREE.NearestMipMapNearestFilter,l.minFilter=THREE.NearestMipMapNearestFilter,l.anisotropy=16;let o=e.obj.position,a=e.obj.boundingBox.center,s=e.obj.size,r=[a[0]-o[0],.05*i.height/2+s[1],a[2]-o[2]];"3"==e.bbIdx?r[0]=r[0]+.05*i.width/2:"6"==e.bbIdx&&(r[0]=r[0]+.05*i.width/2-.05*i.width/(i.width/44));let p=n.app.create({type:"Plane",width:.05*i.width,height:.05*i.height,parent:e.obj,localPosition:r,style:{color:16777215,opacity:.9}});p.node.children[0].material=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide,transparent:!0,map:l,envMaps:null}),p.pickable=!1,p.visible=!1,e.obj.userData.sceneCard=p,n.registerEvent(e.obj,t),e.obj.on(THING.EventType.MouseEnter,(function(e){let t=e.object.userData.sceneCard;null!=t&&"Plane"==t.type&&(t.style.outlineColor=null)}),"CampusInfoCardObjPick"+e.obj.id)})}registerEvent(e,t){let n=e.userData.sceneCard;if(null==n)return;let i=e.userData.bbModel;if(null==i&&(i="always"),i=i.toLowerCase(),this.defalutNum+=1,$("#tb-line"+e.id).length>0)for(let n in t)$("#tb-line"+e.id+" #"+n.split(" ")[0]).html(t[n]);else this.topCardInfoToObject(e,t);$(".tj-panel-container").animate({scrollTop:0},10),"always"==i?n.visible=!0:"click"==i?e.on("singleclick",(function(){n.visible=!n.visible}),"CampusInfoCardClick"+e.id):"float"==i&&(e.on("mouseenter",(function(){n.visible=!0}),"CampusInfoCardFloatEnter"+e.id),e.on("mouseleave",(function(){n.visible=!1}),"CampusInfoCardFloatLeave"+e.id))}offEvent(e){e.off("singleclick",null,"CampusInfoCardClick"+e.id),e.off("mouseenter",null,"CampusInfoCardFloatEnter"+e.id),e.off("mouseleave",null,"CampusInfoCardFloatLeave"+e.id)}getHtml(e){if(null==e)return null;let t="";return"1"==e.bbIdx?(t+='<div id="scene-card-'+e.obj.id+'" style="position: absolute; left: -600px; top: 0; width: 319px; height: 150px;transform: scaleX('+e.scaleW+") scaleY("+e.scaleH+')">\n                    <div style="width: 319px; height: 150px; background: url(\'/guide/ScenePreview/assets/img/topcard/scene/01.png\') no-repeat;"></div>',null!=e.title0&&(t+='<div class="card-title0" style="position: absolute; left: 0; top: 0; width: 93px; height: 100px; font-size: 80px; font-weight: bold; color: rgba(18.8%, 52.5%, 87.8%, 1); vertical-align: middle; text-align: center; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title0+"</div>"),null!=e.title1&&(t+='<div class="card-title1" style="position: absolute; left: 93px; top: 21px; width: 220px; height: 67px; font-size: 36px; font-weight: bold; color: rgba(40%, 40%, 40%, 1); overflow: hidden; white-space: nowrap; user-select: none;">'+e.title1+"</div>"),null!=e.title2&&(t+='<div class="card-title2" style="position: absolute; left: 93px; top: 67px; width: 220px; height: 30px; font-size: 12px; color: rgba(18.8%, 52.5%, 87.8%, 1); overflow: hidden; white-space: nowrap; user-select: none;">'+e.title2+"</div>"),t+="</div>"):"2"==e.bbIdx?(t+='<div id="scene-card-'+e.obj.id+'" style="position: absolute; left: -600px; top: 0; width: 136px; height: 297px;transform: scaleX('+e.scaleW+") scaleY("+e.scaleH+')">\n                    <div style="width: 136px; height: 297px; background: url(\'/guide/ScenePreview/assets/img/topcard/scene/02.png\') no-repeat;"></div>',null!=e.title0&&(t+='<div class="card-title0" style="position: absolute; left: 0; top: 0; width: 136px; height: 136px; line-height: 136px; font-size: 80px; color: rgba(0, 0, 0, 1); vertical-align: middle; text-align: center; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title0+"</div>"),t+="</div>"):"3"==e.bbIdx?(t+='<div id="scene-card-'+e.obj.id+'" style="position: absolute; left: -600px; top: 0; width: 338px; height: 230px;transform: scaleX('+e.scaleW+") scaleY("+e.scaleH+')">\n                    <div style="width: 338px; height: 230px; background: url(\'/guide/ScenePreview/assets/img/topcard/scene/03.png\') no-repeat;"></div>',null!=e.title0&&(t+='<div class="card-title0" style="position: absolute; left: 0; top: 0; width: 93px; height: 100px; font-size: 80px; font-weight: bold; color: rgba(100%, 100%, 100%, 1); vertical-align: middle; text-align: center; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title0+"</div>"),null!=e.title1&&(t+='<div class="card-title1" style="position: absolute; left: 93px; top: 21px; width: 248px; height: 40px; font-size: 30px; color: rgba(100%, 100%, 100%, 1); overflow: hidden; white-space: nowrap; user-select: none;">'+e.title1+"</div>"),null!=e.title2&&(t+='<div class="card-title2" style="position: absolute; left: 93px; top: 70px; width: 245px; height: 24px; font-size: 14px; color: rgba(100%, 100%, 100%, 1); overflow: hidden; white-space: nowrap; user-select: none;">'+e.title2+"</div>"),t+="</div>"):"4"==e.bbIdx?(t+='<div id="scene-card-'+e.obj.id+'" style="position: absolute; left: -600px; top: 0; width: 122px; height: 153px;transform: scaleX('+e.scaleW+") scaleY("+e.scaleH+')">\n                    <div style="width: 122px; height: 153px; background: url(\'/guide/ScenePreview/assets/img/topcard/scene/04.png\') no-repeat;"></div>',null!=e.title0&&(t+='<div class="card-title0" style="position: absolute; left: 0; top: 0; width: 81px; height: 81px; font-size: 48px; color: rgba(100%, 100%, 100%, 1); vertical-align: bottom; text-align: right; line-height: 112px; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title0+"</div>"),null!=e.title1&&(t+='<div class="card-title1" style="position: absolute; left: 81px; top: 0px; width: 40px; height: 75px; font-size: 25px; font-weight: bold; color: rgba(100%, 100%, 100%, 1); vertical-align: bottom; text-align: left; line-height: 125px; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title1+"</div>"),null!=e.title2&&(t+='<div class="card-title2" style="position: absolute; left: 25px; top: 81px; width: 74px; height: 25px; font-size: 20px; color: rgba(100%, 100%, 100%, 1); vertical-align: middle; text-align: center; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title2+"</div>"),t+="</div>"):"5"==e.bbIdx?(t+='<div id="scene-card-'+e.obj.id+'" style="position: absolute; left: -600px; top: 0; width: 417px; height: 364px;transform: scaleX('+e.scaleW+") scaleY("+e.scaleH+')">\n                    <div style="width: 417px; height: 364px; background: url(\'/guide/ScenePreview/assets/img/topcard/scene/05.png\') no-repeat;"></div>',null!=e.title0&&(t+='<div class="card-title0" style="position: absolute; left: 0; top: 0; width: 417px; height: 82px; font-size: 42px; color: rgba(100%, 100%, 100%, 1); vertical-align: middle; text-align: center; line-height: 82px; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title0+"</div>"),t+="</div>"):"6"==e.bbIdx?(t+='<div id="scene-card-'+e.obj.id+'" style="position: absolute; left: -600px; top: 0; width: 386px; height: 159px;transform: scaleX('+e.scaleW+") scaleY("+e.scaleH+')">\n                    <div style="width: 386px; height: 159px; background: url(\'/guide/ScenePreview/assets/img/topcard/scene/06.png\') no-repeat;"></div>',null!=e.title0&&(t+='<div class="card-title0" style="position: absolute; left: 0; top: 0; width: 93px; height: 100px; font-size: 80px; font-weight: bold; color: rgba(100%, 100%, 100%, 1); vertical-align: middle; text-align: center; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title0+"</div>"),null!=e.title1&&(t+='<div class="card-title1" style="position: absolute; left: 93px; top: 21px; width: 245px; height: 40px; font-size: 30px; color: rgba(100%, 100%, 100%, 1); overflow: hidden; white-space: nowrap; user-select: none;">'+e.title1+"</div>"),null!=e.title2&&(t+='<div class="card-title2" style="position: absolute; left: 93px; top: 70px; width: 245px; height: 24px; font-size: 14px; color: rgba(100%, 100%, 100%, 1); overflow: hidden; white-space: nowrap; user-select: none;">'+e.title2+"</div>"),t+="</div>"):"7"==e.bbIdx&&(t+='<div id="scene-card-'+e.obj.id+'" style="position: absolute; left: -600px; top: 0; width: 386px; height: 115px;transform: scaleX('+e.scaleW+") scaleY("+e.scaleH+')">\n                    <div style="width: 386px; height: 115px; background: url(\'/guide/ScenePreview/assets/img/topcard/scene/07.png\') no-repeat;"></div>',null!=e.title0&&(t+='<div class="card-title0" style="position: absolute; left: 0; top: 0; width: 123px; height: 115px; font-size: 100px; font-weight: bold; color: rgba(100%, 100%, 100%, 1); line-height: 115px; vertical-align: middle; text-align: center; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title0+"</div>"),null!=e.title1&&(t+='<div class="card-title1" style="position: absolute; left: 123px; top: 0; width: 185px; height: 115px; font-size: 67px; font-weight: bold; color: rgba(100%, 100%, 100%, 1); line-height: 115px; vertical-align: middle; text-align: center; overflow: hidden; white-space: nowrap; user-select: none;">'+e.title1+"</div>"),null!=e.title2&&(t+='<div class="card-title2" style="position: absolute; left: 308px; top: 30px; width: 78px; height: 28px; font-size: 24px; color: rgba(100%, 100%, 100%, 1); overflow: hidden; white-space: nowrap; user-select: none;">'+e.title2+"</div>"),null!=e.title3&&(t+='<div class="card-title2" style="position: absolute; left: 308px; top: 58px; width: 78px; height: 28px; font-size: 24px; color: rgba(100%, 100%, 100%, 1); overflow: hidden; white-space: nowrap; user-select: none;">'+e.title3+"</div>"),t+="</div>"),t}getDecodeText(e){if(null==e)return null;let t=e+"";return-1!=t.indexOf("</color>")&&(t=t.replace(/<color=/g,"<font color="),t=t.replace(/<\/color>/g,"</font>")),-1!=t.indexOf("</size>")&&(t=t.replace(/<size=/g,"<font size="),t=t.replace(/<\/size>/g,"</font>")),t}getPivotPixel(e){if(null==e)return[0,0];let t=e.bbIdx;return"1"==t||"2"==t||"4"==t||"5"==t||"7"==t?[parseFloat($("#scene-card-"+e.obj.id).css("width"))/2,parseFloat($("#scene-card-"+e.obj.id).css("height"))*((1-e.scaleH)/2+e.scaleH)]:"3"==t?[parseFloat($("#scene-card-"+e.obj.id).css("width"))*((1-e.scaleW)/2),parseFloat($("#scene-card-"+e.obj.id).css("height"))*((1-e.scaleH)/2+e.scaleH)]:"6"==t?[44,parseFloat($("#scene-card-"+e.obj.id).css("height"))]:void 0}topCardInfoPanel(){$("head").append($('\n            <style>\n                .tips{\n                    position: absolute;\n                    top: 68px;\n                    left: 50%;\n                    z-index: 999;\n                    background: #fff;\n                    padding: 12px 20px;\n                    font-size: 15px;\n                    border-radius: 3px;\n                    transform: translateX(-50%);\n                }\n                .tj-panel {\n                    padding-top: 40px;\n                    position: absolute;\n                    right: 10px; \n                    top: 133px; \n                    width: 315px; \n                    height: 416px;\n                    transform: none;\n                    box-sizing: border-box;\n                    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Helvetica,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",SimSun,sans-serif;\n                    color: #fff;\n                    overflow: hidden;\n                    user-select: none;\n                    background-color: rgba(17,17,17,0.88);\n                    z-index: 9;\n                    border: 1px solid #333;\n                }\n                .tj-panel .tj-close {\n                    position: absolute;\n                    top: 10px;\n                    right: 10px;\n                    width: 16px;\n                    height: 16px;\n                    cursor: pointer;\n                    z-index: 99;\n                  }\n                  .tj-panel .tj-title {\n                    height: 40px;\n                    padding: 10px 30px 10px 10px;\n                    line-height: 20px;\n                    font-size: 14px;\n                    user-select: none;\n                    -webkit-user-select: none;\n                    -moz-user-select: -moz-none;\n                    border-bottom: 1px solid #666;\n                    margin-top: -40px;\n                    background-color: rgba(0,0,0,0.88);\n                    white-space: nowrap;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                  }\n                  .tj-close {\n                    position: absolute;\n                    right: 15px;\n                    top: 10px;\n                    font-size: 16px;\n                    color: #4a90e2;\n                  }\n                  .tj-panel *{\n                    box-sizing: border-box;\n                  }\n                  .tj-panel .tj-close:before {\n                    transform: rotate(45deg);\n                  }\n                  .tj-panel .tj-close:after, .tj-panel .tj-close:before {\n                    content: \'\';\n                    display: block;\n                    width: 16px;\n                    height: 1px;\n                    background-color: #fff;\n                    position: absolute;\n                    margin-top: 8px;\n                  }\n                  .tj-panel .tj-close:after {\n                    transform: rotate(-45deg);\n                  }\n                  .tj-panel .tj-close:after, .tj-panel .tj-close:before {\n                    content: \'\';\n                    display: block;\n                    width: 16px;\n                    height: 1px;\n                    background-color: #fff;\n                    position: absolute;\n                    margin-top: 8px;\n                  }\n                  .tj-close::after {\n                    display: inline-block;\n                    content: "e603";\n                    font-family: "gld-bimface" !important;\n                    font-style: normal;\n                    -webkit-font-smoothing: antialiased;\n                    -moz-osx-font-smoothing: grayscale;\n                  }\n                  .tj-panel .tj-table {\n                    width: 100%;\n                    border-collapse: collapse;\n                    font-size: 12px;\n                  }\n                  .tj-panel .tj-table .tj-group-title {\n                    background-color: rgba(85,85,85,0.45);\n                  }\n                  .tj-panel .tj-table .th-num {\n                    width: 10%;\n                    text-align: center\n                  }\n                  .tj-panel .tj-table .tj-key {\n                    width: 42%;\n                  }\n                  .tj-panel .tj-table td {\n                    vertical-align: middle;\n                    line-height: 20px;\n                    padding: 5px;\n                    border: 1px solid #3f3f3f;\n                  }\n                  .tree-panel .tj-panel-container, .property-panel .tj-panel-container {\n                    padding-bottom: 3.2em;\n                  }\n                  .tj-panel .tj-panel-container {\n                    width: 100%;\n                  height: 380px;\n                    overflow-y: auto;\n                    position: relative;\n                  }\n                  .tj-scroll-bar::-webkit-scrollbar {\n                    width: 8px;\n                    height: 8px;\n                    border-radius: 5px;\n                  }\n                  .tj-scroll-bar::-webkit-scrollbar-corner {\n                    background-color: transparent;\n                  }\n                  .tj-scroll-bar::-webkit-scrollbar-thumb {\n                    border-radius: 5px;\n                    background-color: rgba(153,153,153,0.8);\n                  }\n                  .tj-scroll-bar::-webkit-scrollbar-track {\n                    border-radius: 5px;\n                    background-color: rgba(102,102,102,0.2);\n                  }\n                  .color{\n                    color:#11dab7!important;\n                  }\n                  .empty{\n                  font-size: 18px;\n                  position: absolute;\n                  top:35%;\n                  left: 50%;\n                  transform: translate(-50%);\n                  }\n            </style>')),$("#div2d").append('<div id="dataDetails" class="tj-panel property-panel tj-has-title tj-sizable tj-property-panel tj-pinned" style="position: absolute; right: 10px; top: 130px; width: 315px; height: 416px; transform: none;">\n                <div class="tj-close"></div>\n                <div class="tj-title" style="user-select: none;">顶牌信息详情</div>\n                <div class="tj-panel-body" style="padding-top: 0px;">\n                    <div class="tj-panel-container tj-scroll-bar">\n                        <table class="tj-table">\n                            <div class="empty">暂无顶牌数据</div>\n                        </table>\n                    </div>\n                </div>\n            </div>'),$(".tj-close").on("click",(function(){$("#dataDetails").css("display","none")}))}topCardInfoToObject(e,t){let n=e;$(".empty")&&$(".empty").remove(),$(".tj-panel-container").animate({scrollTop:0},10);let i='<tbody class="tj-group" id="tb-line'+n.id+'">\n                    <tr class="tj-group-title"><td colspan="3"><i class="tj-icon"></i>ID :  '+n.id+"</td></tr>\n                </tbody>";$(".tj-table").prepend(i);let l=1;for(var o in t)if(null!=t[o]){let e='\n                        <tr class="tj-group-content">\n                            <td class="th-num">'+l+'</td>\n                            <td class="tj-key">'+o+'</td>\n                            <td class="tj-value" id="'+o.split(" ")[0]+'">'+t[o]+"</td>\n                        </tr>\n                    ";$("#tb-line"+n.id).append(e),l++}}}},0:
/*!***************************!*\
  !*** multi ./src/main.js ***!
  \***************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){e.exports=n(/*! ./src/main.js */"./src/main.js")}})}));
